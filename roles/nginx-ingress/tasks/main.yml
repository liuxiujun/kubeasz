- name: 下载nginx ingress helm package
  copy: src=nginx-ingress/ dest={{ base_dir }}/manifests/nginx-ingress

- name: helm 安装 nginx ingress
#  shell: "{{ bin_dir }}/helm install --namespace nginx-ingress --name nginx-ingress {{ base_dir }}/manifests/nginx-ingress --set rbac.create=true --set controller.service.type=NodePort  --set controller.service.nodePorts.http={{ controller_service_nodePorts_http  }} --set controller.service.nodePorts.https={{ controller_service_nodePorts_https }}  --set controller.image.repository={{ controller_image_repository }} --set controller.image.tag={{ controller_image_tag }} --set defaultBackend.image.repository={{ defaultBackend_image_repository }} --set defaultBackend.image.tag={{ defaultBackend_image_tag }}"
  shell: "{{ bin_dir }}/helm install --namespace nginx-ingress --name nginx-ingress {{ base_dir }}/manifests/nginx-ingress --set rbac.create=true --set controller.image.repository={{ controller_image_repository }} --set controller.image.tag={{ controller_image_tag }} --set defaultBackend.image.repository={{ defaultBackend_image_repository }} --set defaultBackend.image.tag={{ defaultBackend_image_tag }} --set controller.daemonset.useHostPort=true --set controller.hostNetwork=true"
